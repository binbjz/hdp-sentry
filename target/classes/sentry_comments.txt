#------第一套测试环境---------------
gh-data-hdp-qa01.corp.sankuai.com
gh-data-hdp-qa02.corp.sankuai.com
gh-data-hdp-qa03.corp.sankuai.com
gh-data-hdp-qa04.corp.sankuai.com
gh-data-hdp-qa05.corp.sankuai.com
#------第二套测试环境----------------
gh-data-hadoop-qa-test01
gh-data-hadoop-qa-test02
gh-data-hadoop-qa-test03
gh-data-hadoop-qa-test04
gh-data-hadoop-qa-test05


#---------手工授权 验证测试----------------------------
ROLE_NAME=hdp_qa
ROLE_GROUP=hdp_qa
GROUP_ROLE_NAME1=dim_group_role
ROLE_GROUP1=dim_group
GROUP_ROLE_NAME2=dw_group_role
ROLE_GROUP2=dw_group
USER_ROLE_NAME=hdp_qa_role
USER=hdp_qa

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r 'mt_qa'
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r 'mt_qa' -g 'mt_qa'
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -grant_privilege_role --rolename 'mt_qa' --privilege "server=server1->action=all"


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r 'dim_group_role'
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r 'dim_group_role' -g 'dim_group'
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -grant_privilege_role --rolename 'dim_group_role' --privilege "server=server1->db=test_login_db->action=all"


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r 'dw_group_role'
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r 'dw_group_role' -g 'dw_group'
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -grant_privilege_role --rolename 'dw_group_role' --privilege "server=server1->db=test_login_db_tbl->table=test_tbl->action=all"


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r 'hdp_qa_role'
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_user -r 'hdp_qa_role' -u 'hdp_qa'
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -grant_privilege_role --rolename 'hdp_qa_role' --privilege "server=server1->action=all"

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --list_role -u hdp_qa
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --list_privilege -r hdp_qa_role

#----检查用户的角色和其上的权限
[sankuai@gh-data-hadoop-qa-test03.corp.sankuai.com:~]$ /opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --list_role -u hdp_qa
17/11/28 20:11:13 INFO persistent.HAContext: Connecting to ZooKeeper without authentication
17/11/28 20:11:13 INFO imps.CuratorFrameworkImpl: Starting
17/11/28 20:11:13 INFO state.ConnectionStateManager: State change: CONNECTED
17/11/28 20:11:13 INFO thrift.HAClientInvocationHandler: Sentry Client using server gh-data-hadoop-qa-test04.corp.sankuai.com:8038
hdp_qa_role
17/11/28 20:11:14 INFO persistent.HAContext: ShutdownHook closing curator framework
[sankuai@gh-data-hadoop-qa-test03.corp.sankuai.com:~]$ /opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --list_privilege -r hdp_qa_role
17/11/28 20:11:32 INFO persistent.HAContext: Connecting to ZooKeeper without authentication
17/11/28 20:11:32 INFO imps.CuratorFrameworkImpl: Starting
17/11/28 20:11:32 INFO state.ConnectionStateManager: State change: CONNECTED
17/11/28 20:11:32 INFO thrift.HAClientInvocationHandler: Sentry Client using server gh-data-hadoop-qa-test04.corp.sankuai.com:8038
server=server1->action=all
17/11/28 20:11:32 INFO persistent.HAContext: ShutdownHook closing curator framework



#-------检查acl权限
source /opt/meituan/hadoop/bin/hadoop_user_login.sh hive
/opt/meituan/hadoop/bin/hadoop fs -getfacl /user/hive/warehouse/testdb.db/tbl4jarfile

/opt/meituan/hadoop/bin/hadoop fs -getfacl /user/hive/warehouse/testdb1.db/testtable
# file: /user/hive/warehouse/testdb1.db/testtable
# owner: mt_qa
# group: hive
user::rwx
user:mt_qa:rwx
group:mt_test:rwx
group:sentry_qa:rwx
group:supergroup:rwx
group:mt_qa:rwx
mask::rwx
other::--x

#--------举例：
[sankuai@gh-data-hadoop-qa-test03.corp.sankuai.com:~]$ source /opt/meituan/hadoop/bin/hadoop_user_login.sh
Usage: hadoop_user_login.sh $hadoop_user
[sankuai@gh-data-hadoop-qa-test03.corp.sankuai.com:~]$ source /opt/meituan/hadoop/bin/hadoop_user_login.sh hive

[sankuai@gh-data-hadoop-qa-test03.corp.sankuai.com:~]$ /opt/meituan/hadoop/bin/hadoop fs -getfacl /user/hive/warehouse/testdb.db/tbl4jarfile
# file: /user/hive/warehouse/testdb.db/tbl4jarfile
# owner: hive
# group: hive
user::rwx




#login
ssh gh-data-hdp-qa03.corp.sankuai.com
sudo -iusankuai
cd /home/sankuai/spark-test
vim src/main/resource/dispathcer.sh


#login
ssh gh-data-hdp-qa03.corp.sankuai.com
sudo -iusankuai

1. su to root
$ sudo less /opt/meituan/log_agent/logs/log_agent.info
!

2.
rm -rf /opt/meituan/qa_test/sentry-test


3. exit to jinxin02
exit

4. clone code to jinxin02 directory
git clone ssh://git@git.sankuai.com/~zhaobin11/sentry-test.git

5. su to root
sudo -iu sankuai
$ sudo less /opt/meituan/log_agent/logs/log_agent.info
!

6. copy directory to /opt/meituan/qa_test
\cp -rp /home/zhaobin11/sentry-test /opt/meituan/qa_test/

8. change own to sankuai
chown sankuai:sankuai -R /opt/meituan/qa_test/sentry-test

9. cd sentry-test with sankuai user
cd /opt/meituan/qa_test/sentry-test

10.
git branch -a -vv
git checkout -b sentry_bin --track origin/sentry_bin

11. change own with root
chown sankuai:sankuai -R /opt/meituan/qa_test/sentry-test


execute command:
1. grant mt_qa privilege to super
source /opt/meituan/qa_test/sentry-test/src/main/resources/sentry_env.sh (setup|check|clean) SuperPrivil

2. grant mt_qa privilege to ServerAlter (hdp_qa)
source /opt/meituan/qa_test/sentry-test/src/main/resources/sentry_env.sh (setup|check|clean) ServerAlter

3. login hive shell with mt_qa to execute prepare sql
source /opt/meituan/qa_test/sentry-test/src/main/resources/hive_env.sh proxy_user super
echo $HADOOP_PROXY_USER

/opt/meituan/hive-1.2/bin/hive --hiveconf hive.cli.errors.ignore=true -f /opt/meituan/qa_test/sentry-test/src/test/resources/ServerAlter/hive-sql/prepareServerAlter.sql

4. login hive shell with hdp_qa execute test case
source /opt/meituan/qa_test/sentry-test/src/main/resources/hive_env.sh proxy_user normal
echo $HADOOP_PROXY_USER

/usr/bin/time -f "Time: %U" java -Djava.ext.dirs=/opt/meituan/qa_test/data_bin/ -cp /opt/meituan/qa_test/sentry-test/target/classes:/opt/meituan/qa_test/sentry-test/target/test-classes/ org.junit.runner.JUnitCore ServerAlter





##==revoke sentry privilege
source /opt/meituan/qa_test/sentry-test/src/main/resources/hive_env.sh clean_proxy_user hive

##======all log
less src/test/log/sentry-test.log
/opt/meituan/qa_test/sentry-test/src/test/resources/ServerAlter/hive-output/*
/opt/meituan/qa_test/sentry-test/src/test/log

less src/test/log/sentry-test.log
/opt/meituan/qa_test/sentry-test/src/test/log


##=====run script
cd /opt/meituan/qa_test/sentry-test/src/main/resources
bash sentry_dispatcher.shå




update external ini files
copy new ini file to sentry server by misid
$ scp external.ini <userName>@gh-data-hdp-qa03.corp.sankuai.com:/tmp
<userName>@gh-data-hdp-qa03.corp.sankuai.com's password:
external.ini                                                                  100% 3454     3.4KB/s   00:00
$ scp external.ini <userName>@gh-data-hdp-qa04.corp.sankuai.com:/tmp
<userName>@gh-data-hdp-qa04.corp.sankuai.com's password:
external.ini                                                                  100% 3454     3.4KB/s   00:00
$ scp external.ini <userName>@gh-data-hdp-qa05.corp.sankuai.com:/tmp


update external ini files
$ cp /tmp/external.ini external.ini
cp: overwrite `external.ini'? yes
copy new ini file to sentry server by misid
[lijinxin02@gh-data-hdp-qa03 resources]$ scp external.ini lijinxin02@gh-data-hdp-qa03.corp.sankuai.com:/tmp
lijinxin02@gh-data-hdp-qa03.corp.sankuai.com's password:
external.ini                                                                  100% 3454     3.4KB/s   00:00
[lijinxin02@gh-data-hdp-qa03 resources]$ scp external.ini lijinxin02@gh-data-hdp-qa04.corp.sankuai.com:/tmp
lijinxin02@gh-data-hdp-qa04.corp.sankuai.com's password:
external.ini                                                                  100% 3454     3.4KB/s   00:00
[lijinxin02@gh-data-hdp-qa03 resources]$ scp external.ini lijinxin02@gh-data-hdp-qa05.corp.sankuai.com:/tmp

update ini file
[sankuai@gh-data-hdp-qa04.corp.sankuai.com:/opt/meituan/sentry/conf]$ cp /tmp/external.ini external.ini
cp: overwrite `external.ini'? yes



#-------------restart hms and sentry service
sentry服务的重启：在dx-data-hive-metastore01切到sankuai用户，执行sudo svc -t /service/meituan.data.hadoop.sentry
跟sentry类似，重启HMS：sudo svc -t /service/meituan.data.hive.hive/


#---HIVE CLIENT
sudo -iusankuai
export HADOOP_JAR_AUTHENTICATION=KERBEROS
export HADOOP_JAR_KERBEROS_KEYTAB_FILE=/etc/hadoop/keytabs/hadoop-launcher.keytab
export HADOOP_JAR_KERBEROS_PRINCIPAL=hadoop-launcher/_HOST@SANKUAI.COM
export HADOOP_PROXY_USER=server_all
/opt/meituan/hive-1.2/bin/hive

#----第三种登陆方式 用户激活组
sudo -iusankuai
export HADOOP_JAR_AUTHENTICATION=KERBEROS
export HADOOP_JAR_KERBEROS_KEYTAB_FILE=/etc/hadoop/keytabs/hadoop-launcher.keytab
export HADOOP_JAR_KERBEROS_PRINCIPAL=hadoop-launcher/_HOST@SANKUAI.COM
export HADOOP_PROXY_USER=hdp_qa/hdp_qa@ba_ups_group,dim_group,dw_group,mart_waimai_group,mart_waimai_crm_group,mart_wmorg_group,origin_waimai_group,origindb_group,origindb_delta_group,origin_dianping_group


# user group 对应关系的ini文件
hdp_qa=hdp_qa,ba_ups_group,dim_group,dw_group,mart_waimai_group,mart_waimai_crm_group,mart_wmorg_group,origin_waimai_group,origindb_group,origindb_delta_group,origin_dianping_group


java -cp .:./junit.jar:./sentry_test.jar:./hamcrest-core-1.3.jar org.junit.runner.JUnitCore TestServerAll


hadoop-launcher.keytab
export HADOOP_JAR_KERBEROS_KEYTAB_FILE=/etc/hadoop/keytabs/hadoop-launcher.keytab
export HADOOP_JAR_KERBEROS_PRINCIPAL=hadoop-launcher/_HOST@SANKUAI.COM
export HADOOP_PROXY_USER=server_all


方式与proxy user基本相同，只是proxy user指定了具体的激活组
具体写法为export HADOOP_PROXY_USER=hadoop-qa/misid@group1,group2
其中group名称可以有多个，以逗号分隔；如果指定的激活组不是user对应的有效组，会直接抛出异常








#---SENTRY SHELL
#---初始环境
sudo -iusankuai
export HADOOP_HOME=/opt/meituan/hadoop
export HIVE_HOME=/opt/meituan/hive-1.2
source /opt/meituan/hadoop/bin/hadoop_user_login.sh hive


[sankuai@gh-data-hdp-qa03.corp.sankuai.com:~]$ /opt/meituan/sentry/bin/sentryShell --help
usage: sentryShell
 -arg,--add_role_group          Add role to grou_rp
 -aru,--add_role_user           Add role to user
 -conf,--sentry_conf <arg>      sentry-site file path
 -cr,--create_role              Create role
 -dr,--drop_role                Drop role
 -drg,--delete_role_group       Delete role from group
 -dru,--delete_role_user        Delete role from user
 -g,--groupname <arg>           Group name
 -gpr,--grant_privilege_role    Grant privilege to role
 -h,--help                      Shell usage
 -lp,--list_privilege           List privilege
 -lr,--list_role                List role
 -p,--privilege <arg>           Privilege string
 -r,--rolename <arg>            Role name
 -rpr,--revoke_privilege_role   Revoke privilege from role
 -t,--type <arg>                [hive|solr|sqoop|.....]
 -u,--username <arg>            User name
 
 


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r sentry_qa
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r sentry_qa -g sentry_qa
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --rolename sentry_qa --privilege "server=server1->db=test_db->action=all"

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --revoke_privilege_role -r sentry_qa_1 -p "server=server1->db=test_db->action=all"
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --delete_role_group -r sentry_qa_1 -g sentry_qa_1
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --drop_role -r sentry_qa_1

create_role -r sentry_qa
add_role_group -r sentry_qa -g sentry_qa
drop_role -r sentry_qa
没有执行 delete_role_group -r sentry_qa -g sentry_qa
下次再加入同名ROLE 之前ROLE与GROUP的关系是否还起效？


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r sentry_qa_role2
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r sentry_qa_role2 -g sentry_qa_group2
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --role sentry_qa_role2 --privilege "server=server1->db=test_db2->action=all"


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_user -r sentry_qa_role -u sentry_qa
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --role sentry_qa --privilege "server=server1->db=test_db->action=all"


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r dim_group_role
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r dim_group_role -g dim_group
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --rolename dim_group_role --privilege "server=server1->db=test_db1->action=all"

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r dw_group_role
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r dw_group_role -g dw_group
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --rolename dw_group_role --privilege "server=server1->db=test_db2->action=all"


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --revoke_privilege_role -r dw_group_role -p "server=server1->db=test_db2->action=all"
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --drop_role -r dw_group_role

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --delete_role_group -r dw_group_role -g dw_group


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r hdp_qa_role
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_user -r hdp_qa_role -u hdp_qa
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --rolename hdp_qa_role --privilege "server=server1->db=test_db->action=all"


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r dim_group_role
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r dim_group_role -g dim_group
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --rolename dim_group_role --privilege "server=server1->db=test_db1->action=all"


 
 
create_role -r dim_group_role
add_role_group -r dim_group_role -g dim_group
grant_privilege_role --rolename dim_group_role --privilege "server=server1->db=test_db1->action=all"

create_role -r dw_group_role
add_role_group -r dw_group_role -g dw_group
grant_privilege_role --rolename dw_group_role --privilege "server=server1->db=test_db2->action=all"

create_role -r hdp_qa_role
add_role_user -r hdp_qa_role -u hdp_qa
grant_privilege_role --rolename hdp_qa_role --privilege "server=server1->db=test_db->action=all"




export HADOOP_PROXY_USER=hdp_qa/hdp_qa@ALL
/opt/meituan/hive-1.2/bin/hive
hive (default)> show databases;
OK
default
test_db
test_db1
test_db2

export HADOOP_PROXY_USER=hdp_qa/hdp_qa@dim_group,dw_group
/opt/meituan/hive-1.2/bin/hive
hive (default)> SHOW DATABASES;
OK
default
test_db1
test_db2
 
 


sudo -iusankuai
export HADOOP_JAR_AUTHENTICATION=KERBEROS
export HADOOP_JAR_KERBEROS_KEYTAB_FILE=/etc/hadoop/keytabs/hadoop-launcher.keytab
export HADOOP_JAR_KERBEROS_PRINCIPAL=hadoop-launcher/_HOST@SANKUAI.COM
export HADOOP_PROXY_USER=hadoop-qa/hdp_qa@all
/opt/meituan/hive-1.2/bin/hive


hadoop-qa/misid




hdp_qa=hdp_qa
,ba_ups_group
,dim_group
,dw_group
,mart_waimai_group
,mart_waimai_crm_group
,mart_wmorg_group
,origin_waimai_group
,origindb_group
,origindb_delta_group
,origin_dianping_group




/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r sentry_qa_role1
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r sentry_qa_role1 -g sentry_qa_group1
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --role sentry_qa_role1 --privilege "server=server1->db=test_db1->->action=all"

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r sentry_qa_role2
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r sentry_qa_role2 -g sentry_qa_group2
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --role sentry_qa_role2 --privilege "server=server1->db=test_db2->action=all"


/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_user -r sentry_qa_role -u sentry_qa
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --role sentry_qa --privilege "server=server1->db=test_db->action=all"

  
Add role, group and privilege

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -create_role -r column_all
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml -add_role_group -r column_all -g column_all_group
/opt/meituan/sentry/bin/sentryShell --conf /opt/meituan/sentry/conf/sentry-site.xml --grant_privilege_role --rolename column_all --privilege "server=server1->db=test_db->table=test_tbl->column=a->action=all"


Remove role, group and privilege

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --revoke_privilege_role -r column_all -p "server=server1->db=test_db->table=test_tbl->column=a->action=all"
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --delete_role_group -r column_all -g column_all_group
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --drop_role -r column_all


Check role, group and privilege

/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --list_role
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --list_role -g column_all_group
/opt/meituan/sentry/bin/sentryShell -conf /opt/meituan/sentry/conf/sentry-site.xml --list_privilege -r column_all



[sankuai@gh-data-hdp-qa03.corp.sankuai.com:~]$ mysql -hmysqldev56.vip.sankuai.com -P5002 -uhadoop_qa -pwH28clTroqdu hadoop_qa


DBS,SDS,CDS,TBLS

show create table sentry_role;





打开关闭HIVE SPARK测试运行
# Set hive env. If run hive sql please comment spark env statements
HIVE_HOME=`readlink -f /opt/meituan/hive-1.2`
cmd_exec="${HIVE_HOME}/bin/hive --hiveconf hive.cli.errors.ignore=true -f"
sql_src=hive-sql
file_suffix=sql

# Set spark env. If run spark sql please comment hive env statements.
: <<COMMENTBLOCK
SPARK_HOME=`readlink -f /opt/meituan/spark-2.1-sentry`
cmd_exec="${SPARK_HOME}/bin/spark-shell --master yarn --deploy-mode client --queue root.hadoop-hdp.etltest"
sql_src=spark-sql
file_suffix=scala
COMMENTBLOCK


方式与proxy user基本相同，只是proxy user指定了具体的激活组
具体写法为export HADOOP_PROXY_USER=hadoop-qa/misid@group1,group2
其中group名称可以有多个，以逗号分隔；如果指定的激活组不是user对应的有效组，会直接抛出异常


