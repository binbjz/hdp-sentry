OK
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:User hdp_qa does not have privileges for ALTERTABLE_ADDPARTS)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:User hdp_qa does not have privileges for ALTERTABLE_ADDPARTS)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:User hdp_qa does not have privileges for ALTERTABLE_ADDPARTS)
Loading data to table testdb.staged_employees partition (country=US, state=CA)
Failed with exception MetaException(message:User hdp_qa does not have privileges for ALTERTABLE_ADDPARTS)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MoveTask
Query ID = sankuai_20171013163746_2778b73a-91bf-48c3-ad0f-f25083665311
Total jobs = 7
Launching Job 1 out of 7
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0825, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0825/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0825
Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 460 msec
Ended Job = job_1505297521386_0825
Stage-10 is selected by condition resolver.
Stage-15 is selected by condition resolver.
Stage-5 is selected by condition resolver.
Stage-9 is filtered out by condition resolver.
Stage-4 is filtered out by condition resolver.
Stage-14 is filtered out by condition resolver.
Stage-6 is filtered out by condition resolver.
Stage-11 is filtered out by condition resolver.
Stage-16 is filtered out by condition resolver.
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/.hive-staging_hive_2017-10-13_16-37-46_927_3452941773220897725-1/-ext-10001
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/.hive-staging_hive_2017-10-13_16-37-46_927_3452941773220897725-1/-ext-10002
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/.hive-staging_hive_2017-10-13_16-37-46_927_3452941773220897725-1/-ext-10000
Loading data to table testdb.employees partition (country=US, state=IL)
Failed with exception MetaException(message:User hdp_qa does not have privileges for ALTERTABLE_ADDPARTS)
Loading data to table testdb.employees partition (country=US, state=CA)
Failed with exception MetaException(message:User hdp_qa does not have privileges for ALTERTABLE_ADDPARTS)
Loading data to table testdb.employees partition (country=US, state=OR)
Failed with exception MetaException(message:User hdp_qa does not have privileges for ALTERTABLE_ADDPARTS)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MoveTask
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 1   Cumulative CPU: 1.46 sec   HDFS Read: 9656 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 460 msec
OK
employees.name	employees.salary	employees.subordinates	employees.deductions	employees.address	employees.country	employees.state
Query ID = sankuai_20171013163815_281b1ef4-bda5-45c1-b67c-aa7099f6d116
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0826, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0826/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0826
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 440 msec
Ended Job = job_1505297521386_0826
Stage-3 is selected by condition resolver.
Stage-2 is filtered out by condition resolver.
Stage-4 is filtered out by condition resolver.
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/.hive-staging_hive_2017-10-13_16-38-15_548_8845892590451751564-1/-ext-10000
Loading data to table testdb.employees partition (country=US, state=CA)
Failed with exception MetaException(message:User hdp_qa does not have privileges for ALTERTABLE_ADDPARTS)
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MoveTask
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 1.44 sec   HDFS Read: 5974 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 440 msec
OK
Query ID = sankuai_20171013163853_4e259ea9-ae68-4f28-bc2e-865afb547e22
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0827, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0827/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0827
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 420 msec
Ended Job = job_1505297521386_0827
Stage-3 is selected by condition resolver.
Stage-2 is filtered out by condition resolver.
Stage-4 is filtered out by condition resolver.
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/.hive-staging_hive_2017-10-13_16-38-53_923_2506989296812655752-1/-ext-10000
Loading data to table testdb.employees partition (country=US, state=null)
	 Time taken for load dynamic partitions : 92
	 Time taken for adding to write entity : 0
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 1.42 sec   HDFS Read: 6188 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 420 msec
OK
se.name	se.salary	se.subordinates	se.deductions	se.address	se.state
OK
employees.name	employees.salary	employees.subordinates	employees.deductions	employees.address	employees.country	employees.state
Query ID = sankuai_20171013163915_df365d83-c31b-46bb-8baf-d8c3b3f42388
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0828, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0828/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0828
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 440 msec
Ended Job = job_1505297521386_0828
Copying data to local directory /tmp/ca_employees
Copying data to local directory /tmp/ca_employees
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 1.44 sec   HDFS Read: 5531 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 440 msec
OK
se.name	se.salary	se.subordinates	se.deductions	se.address	se.country	se.state
total 0
-rw-r----- 1 sankuai sankuai 0 Oct 13 16:39 000000_0
000000_0
Query ID = sankuai_20171013163934_9d0e550b-61e3-48eb-a180-7e7bb7af8004
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0829, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0829/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0829
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
MapReduce Total cumulative CPU time: 3 seconds 610 msec
Ended Job = job_1505297521386_0829
Stage-3 is selected by condition resolver.
Stage-2 is filtered out by condition resolver.
Stage-4 is filtered out by condition resolver.
Moving data to: viewfs://hadoop-meituan-test/tmp/.hive-staging_hive_2017-10-13_16-39-34_327_2572013636940793215-1/-ext-10000
Moving data to: /tmp/union.out
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2   Cumulative CPU: 3.61 sec   HDFS Read: 11326 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 3 seconds 610 msec
OK
unioninput.name	unioninput.salary
Moved: 'viewfs://hadoop-meituan-test/tmp/union.out' to trash at: hdfs://hadoop-meituan-test/user/hdp_qa/.Trash/Current
Query ID = sankuai_20171013163955_c43de26b-47b0-48cc-99de-85354f30f742
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1505297521386_0830, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0830/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0830
Hadoop job information for Stage-0: number of mappers: 1; number of reducers: 1
MapReduce Total cumulative CPU time: 4 seconds 60 msec
Ended Job = job_1505297521386_0830
MapReduce Jobs Launched: 
Stage-Stage-0: Map: 1  Reduce: 1   Cumulative CPU: 4.06 sec   HDFS Read: 14196 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 4 seconds 60 msec
OK
_c0	_c1	country	state
Query ID = sankuai_20171013164019_50db92d8-c354-4633-91e9-adf56fc220f7
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0831, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0831/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0831
Hadoop job information for Stage-0: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 60 msec
Ended Job = job_1505297521386_0831
MapReduce Jobs Launched: 
Stage-Stage-0: Map: 1   Cumulative CPU: 1.06 sec   HDFS Read: 4579 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 60 msec
OK
testdb.staged_employees.name	testdb.staged_employees.salary	testdb.staged_employees.subordinates	testdb.staged_employees.deductions	testdb.staged_employees.address	testdb.staged_employees.country	testdb.staged_employees.state
Query ID = sankuai_20171013164044_d1545595-297a-4b9f-bb2c-371dad36d907
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0832, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0832/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0832
Hadoop job information for Stage-0: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 20 msec
Ended Job = job_1505297521386_0832
MapReduce Jobs Launched: 
Stage-Stage-0: Map: 1   Cumulative CPU: 1.02 sec   HDFS Read: 3492 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 20 msec
OK
testdb.staged_employees.name	testdb.staged_employees.salary	testdb.staged_employees.subordinates	testdb.staged_employees.deductions	testdb.staged_employees.address	testdb.staged_employees.country	testdb.staged_employees.state
Query ID = sankuai_20171013164104_8b970d5c-da6d-4be1-bb2d-5034f7ae0edc
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0833, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0833/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0833
Hadoop job information for Stage-0: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 10 msec
Ended Job = job_1505297521386_0833
MapReduce Jobs Launched: 
Stage-Stage-0: Map: 1   Cumulative CPU: 1.01 sec   HDFS Read: 3492 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 10 msec
OK
testdb.staged_employees.name	testdb.staged_employees.salary	testdb.staged_employees.subordinates	testdb.staged_employees.deductions	testdb.staged_employees.address	testdb.staged_employees.country	testdb.staged_employees.state
OK
col_name	data_type	comment
name                	string              	                    
salary              	float               	                    
subordinates        	array<string>       	                    
deductions          	map<string,float>   	                    
address             	struct<street:string,city:string,state:string,zip:int>	                    
country             	string              	                    
state               	string              	                    
	 	 
# Partition Information	 	 
# col_name            	data_type           	comment             
	 	 
country             	string              	                    
state               	string              	                    
	 	 
Detailed Table Information	Table(tableName:staged_employees, dbName:testdb, owner:mt_qa, createTime:1507883394, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:name, type:string, comment:null), FieldSchema(name:salary, type:float, comment:null), FieldSchema(name:subordinates, type:array<string>, comment:null), FieldSchema(name:deductions, type:map<string,float>, comment:null), FieldSchema(name:address, type:struct<street:string,city:string,state:string,zip:int>, comment:null), FieldSchema(name:country, type:string, comment:null), FieldSchema(name:state, type:string, comment:null)], location:viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/staged_employees, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{colelction.delim=|, mapkey.delim==, serialization.format=,, line.delim=	 
, field.delim=,}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:country, type:string, comment:null), FieldSchema(name:state, type:string, comment:null)], parameters:{transient_lastDdlTime=1507883394}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE)		 
FAILED: SemanticException [Error 10006]: Partition not found {country=US, state=CA}
