OK
OK
OK
OK
OK
Loading data to table testdb.staged_employees partition (country=US, state=CA)
OK
Query ID = sankuai_20171013200622_3697e24d-4dc1-49a0-a4f7-3774a6bdd144
Total jobs = 7
Launching Job 1 out of 7
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0931, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0931/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0931
Hadoop job information for Stage-3: number of mappers: 2; number of reducers: 0
MapReduce Total cumulative CPU time: 3 seconds 320 msec
Ended Job = job_1505297521386_0931
Stage-15 is filtered out by condition resolver.
Stage-10 is selected by condition resolver.
Stage-5 is selected by condition resolver.
Stage-14 is selected by condition resolver.
Stage-4 is filtered out by condition resolver.
Stage-9 is filtered out by condition resolver.
Stage-6 is filtered out by condition resolver.
Stage-16 is filtered out by condition resolver.
Stage-11 is filtered out by condition resolver.
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/.hive-staging_hive_2017-10-13_20-06-22_248_6603056236926968780-1/-ext-10001
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/.hive-staging_hive_2017-10-13_20-06-22_248_6603056236926968780-1/-ext-10000
Launching Job 7 out of 7
Loading data to table testdb.employees partition (country=US, state=IL)
Number of reduce tasks is set to 0 since there's no reduce operator
Loading data to table testdb.employees partition (country=US, state=OR)
Starting Job = job_1505297521386_0932, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0932/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0932
Hadoop job information for Stage-14: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 140 msec
Ended Job = job_1505297521386_0932
Loading data to table testdb.employees partition (country=US, state=CA)
Moved: 'viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/state=CA' to trash at: hdfs://hadoop-meituan-test/user/hdp_qa/.Trash/Current
4 Rows loaded to testdb.employees
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 2   Cumulative CPU: 3.32 sec   HDFS Read: 23016 HDFS Write: 427 SUCCESS
Stage-Stage-14: Map: 1   Cumulative CPU: 1.14 sec   HDFS Read: 4478 HDFS Write: 427 SUCCESS
Total MapReduce CPU Time Spent: 4 seconds 460 msec
OK
OK
employees.name	employees.salary	employees.subordinates	employees.deductions	employees.address	employees.country	employees.state
John Doe	100000.0	["Mary Smith","Todd Jones"]	{"Federal Taxes":0.2,"State Taxes":0.05,"Insurance":0.1}	{"street":"Michigan Ave.","city":"Chicago","state":"IL","zip":60600}	US	CA
Mary Smith	80000.0	["Bill King"]	{"Federal Taxes":0.2,"State Taxes":0.05,"Insurance":0.1}	{"street":"Ontario St.","city":"Chicago","state":"IL","zip":60601}	US	CA
Todd Jones	70000.0	[]	{"Federal Taxes":0.15,"State Taxes":0.03,"Insurance":0.1}	{"street":"Chicago Ave.","city":"Oak Park","state":"IL","zip":60700}	US	CA
Bill King	60000.0	[]	{"Federal Taxes":0.15,"State Taxes":0.03,"Insurance":0.1}	{"street":"Obscure Dr.","city":"Obscuria","state":"IL","zip":60100}	US	CA
OK
Query ID = sankuai_20171013200709_dd6f9a8b-483e-4af0-8e60-12f34633ccb9
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0933, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0933/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0933
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 210 msec
Ended Job = job_1505297521386_0933
Stage-3 is selected by condition resolver.
Stage-2 is filtered out by condition resolver.
Stage-4 is filtered out by condition resolver.
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/.hive-staging_hive_2017-10-13_20-07-09_536_4610188158781459310-1/-ext-10000
Loading data to table testdb.employees partition (country=US, state=CA)
Moved: 'viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/state=CA' to trash at: hdfs://hadoop-meituan-test/user/hdp_qa/.Trash/Current
4 Rows loaded to testdb.employees
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 1.21 sec   HDFS Read: 6787 HDFS Write: 427 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 210 msec
OK
name	salary	subordinates	deductions	address
OK
employees.name	employees.salary	employees.subordinates	employees.deductions	employees.address	employees.country	employees.state
John Doe	100000.0	["Mary Smith","Todd Jones"]	{"Federal Taxes":0.2,"State Taxes":0.05,"Insurance":0.1}	{"street":"Michigan Ave.","city":"Chicago","state":"IL","zip":60600}	US	CA
Mary Smith	80000.0	["Bill King"]	{"Federal Taxes":0.2,"State Taxes":0.05,"Insurance":0.1}	{"street":"Ontario St.","city":"Chicago","state":"IL","zip":60601}	US	CA
Todd Jones	70000.0	[]	{"Federal Taxes":0.15,"State Taxes":0.03,"Insurance":0.1}	{"street":"Chicago Ave.","city":"Oak Park","state":"IL","zip":60700}	US	CA
Bill King	60000.0	[]	{"Federal Taxes":0.15,"State Taxes":0.03,"Insurance":0.1}	{"street":"Obscure Dr.","city":"Obscuria","state":"IL","zip":60100}	US	CA
OK
Query ID = sankuai_20171013200734_3aa727dd-1c11-4593-b012-d82c63f359a5
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0934, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0934/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0934
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
MapReduce Total cumulative CPU time: 2 seconds 290 msec
Ended Job = job_1505297521386_0934
Stage-3 is selected by condition resolver.
Stage-2 is filtered out by condition resolver.
Stage-4 is filtered out by condition resolver.
Moving data to: viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/.hive-staging_hive_2017-10-13_20-07-34_332_8559562277836269706-1/-ext-10000
Loading data to table testdb.employees partition (country=US, state=null)
Moved: 'viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/employees/country=US/state=CA' to trash at: hdfs://hadoop-meituan-test/user/hdp_qa/.Trash/Current
	 Time taken for load dynamic partitions : 1085
	Loading partition {country=US, state=CA}
	 Time taken for adding to write entity : 0
4 Rows loaded to testdb.employees
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2   Cumulative CPU: 2.29 sec   HDFS Read: 15710 HDFS Write: 427 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 290 msec
OK
se.name	se.salary	se.subordinates	se.deductions	se.address	se.state
OK
employees.name	employees.salary	employees.subordinates	employees.deductions	employees.address	employees.country	employees.state
John Doe	100000.0	["Mary Smith","Todd Jones"]	{"Federal Taxes":0.2,"State Taxes":0.05,"Insurance":0.1}	{"street":"Michigan Ave.","city":"Chicago","state":"IL","zip":60600}	US	CA
Mary Smith	80000.0	["Bill King"]	{"Federal Taxes":0.2,"State Taxes":0.05,"Insurance":0.1}	{"street":"Ontario St.","city":"Chicago","state":"IL","zip":60601}	US	CA
Todd Jones	70000.0	[]	{"Federal Taxes":0.15,"State Taxes":0.03,"Insurance":0.1}	{"street":"Chicago Ave.","city":"Oak Park","state":"IL","zip":60700}	US	CA
Bill King	60000.0	[]	{"Federal Taxes":0.15,"State Taxes":0.03,"Insurance":0.1}	{"street":"Obscure Dr.","city":"Obscuria","state":"IL","zip":60100}	US	CA
Query ID = sankuai_20171013200759_bf800909-65c8-4135-bb99-58496480da72
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0935, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0935/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0935
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 190 msec
Ended Job = job_1505297521386_0935
Copying data to local directory /tmp/ca_employees
Copying data to local directory /tmp/ca_employees
4 Rows loaded to /tmp/ca_employees
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 1.19 sec   HDFS Read: 6241 HDFS Write: 451 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 190 msec
OK
se.name	se.salary	se.subordinates	se.deductions	se.address	se.country	se.state
total 4
-rw-r----- 1 sankuai sankuai 451 Oct 13 20:08 000000_0
Query ID = sankuai_20171013200817_dbc8997d-2f95-4ab4-accb-ecb92871457c
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0936, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0936/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0936
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
MapReduce Total cumulative CPU time: 3 seconds 450 msec
Ended Job = job_1505297521386_0936
Stage-3 is filtered out by condition resolver.
Stage-2 is selected by condition resolver.
Stage-4 is filtered out by condition resolver.
Launching Job 3 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0937, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0937/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0937
Hadoop job information for Stage-2: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 130 msec
Ended Job = job_1505297521386_0937
Moving data to: /tmp/union.out
8 Rows loaded to /tmp/union.out
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2   Cumulative CPU: 3.45 sec   HDFS Read: 15628 HDFS Write: 74 SUCCESS
Stage-Stage-2: Map: 1   Cumulative CPU: 1.13 sec   HDFS Read: 1848 HDFS Write: 74 SUCCESS
Total MapReduce CPU Time Spent: 4 seconds 580 msec
OK
unioninput.name	unioninput.salary
John Doe100000.0
Mary Smith80000.0
Todd Jones70000.0
Bill King60000.0
Moved: 'viewfs://hadoop-meituan-test/tmp/union.out' to trash at: hdfs://hadoop-meituan-test/user/hdp_qa/.Trash/Current
Query ID = sankuai_20171013200856_218e6219-4787-4710-a43c-0ebccf1dc8c3
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1505297521386_0938, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0938/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0938
Hadoop job information for Stage-0: number of mappers: 2; number of reducers: 1
MapReduce Total cumulative CPU time: 10 seconds 520 msec
Ended Job = job_1505297521386_0938
MapReduce Jobs Launched: 
Stage-Stage-0: Map: 2  Reduce: 1   Cumulative CPU: 10.52 sec   HDFS Read: 25075 HDFS Write: 53 SUCCESS
Total MapReduce CPU Time Spent: 10 seconds 520 msec
OK
_c0	_c1	country	state
Query ID = sankuai_20171013200923_3e917bb8-936d-417c-8536-ba7b57a926df
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0939, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0939/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0939
Hadoop job information for Stage-0: number of mappers: 1; number of reducers: 0
MapReduce Total cumulative CPU time: 1 seconds 40 msec
Ended Job = job_1505297521386_0939
Partition testdb.staged_employees{country=US, state=CA} stats: [numFiles=1, numRows=0, totalSize=427, rawDataSize=0]
MapReduce Jobs Launched: 
Stage-Stage-0: Map: 1   Cumulative CPU: 1.04 sec   HDFS Read: 4691 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 1 seconds 40 msec
OK
testdb.staged_employees.name	testdb.staged_employees.salary	testdb.staged_employees.subordinates	testdb.staged_employees.deductions	testdb.staged_employees.address	testdb.staged_employees.country	testdb.staged_employees.state
Query ID = sankuai_20171013200949_be3ddcad-57e5-4fe0-8305-2030648074ed
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0940, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0940/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0940
Hadoop job information for Stage-0: number of mappers: 2; number of reducers: 0
MapReduce Total cumulative CPU time: 2 seconds 50 msec
Ended Job = job_1505297521386_0940
Partition testdb.staged_employees{country=US, state=CA} stats: [numFiles=1, numRows=0, totalSize=427, rawDataSize=0]
Partition testdb.staged_employees{country=US, state=IL} stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
Partition testdb.staged_employees{country=US, state=OR} stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
MapReduce Jobs Launched: 
Stage-Stage-0: Map: 2   Cumulative CPU: 2.05 sec   HDFS Read: 11132 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 50 msec
OK
testdb.staged_employees.name	testdb.staged_employees.salary	testdb.staged_employees.subordinates	testdb.staged_employees.deductions	testdb.staged_employees.address	testdb.staged_employees.country	testdb.staged_employees.state
Query ID = sankuai_20171013201010_7ed6c75e-65f1-4464-a5fc-709fd2f19e4c
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1505297521386_0941, Tracking URL = http://gh-data-hdp-qa04.corp.sankuai.com:8088/proxy/application_1505297521386_0941/
Kill Command = /opt/meituan/hadoop-sentry-qa/bin/hadoop job  -kill job_1505297521386_0941
Hadoop job information for Stage-0: number of mappers: 2; number of reducers: 0
MapReduce Total cumulative CPU time: 2 seconds 80 msec
Ended Job = job_1505297521386_0941
Partition testdb.staged_employees{country=US, state=CA} stats: [numFiles=1, numRows=0, totalSize=427, rawDataSize=0]
Partition testdb.staged_employees{country=US, state=IL} stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
Partition testdb.staged_employees{country=US, state=OR} stats: [numFiles=0, numRows=0, totalSize=0, rawDataSize=0]
MapReduce Jobs Launched: 
Stage-Stage-0: Map: 2   Cumulative CPU: 2.08 sec   HDFS Read: 11474 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 80 msec
OK
testdb.staged_employees.name	testdb.staged_employees.salary	testdb.staged_employees.subordinates	testdb.staged_employees.deductions	testdb.staged_employees.address	testdb.staged_employees.country	testdb.staged_employees.state
OK
col_name	data_type	comment
name                	string              	                    
salary              	float               	                    
subordinates        	array<string>       	                    
deductions          	map<string,float>   	                    
address             	struct<street:string,city:string,state:string,zip:int>	                    
country             	string              	                    
state               	string              	                    
	 	 
# Partition Information	 	 
# col_name            	data_type           	comment             
	 	 
country             	string              	                    
state               	string              	                    
	 	 
Detailed Table Information	Table(tableName:staged_employees, dbName:testdb, owner:mt_qa, createTime:1507895740, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:name, type:string, comment:null), FieldSchema(name:salary, type:float, comment:null), FieldSchema(name:subordinates, type:array<string>, comment:null), FieldSchema(name:deductions, type:map<string,float>, comment:null), FieldSchema(name:address, type:struct<street:string,city:string,state:string,zip:int>, comment:null), FieldSchema(name:country, type:string, comment:null), FieldSchema(name:state, type:string, comment:null)], location:viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/staged_employees, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{colelction.delim=|, mapkey.delim==, serialization.format=,, line.delim=	 
, field.delim=,}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:country, type:string, comment:null), FieldSchema(name:state, type:string, comment:null)], parameters:{transient_lastDdlTime=1507895740}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE)		 
OK
col_name	data_type	comment
name                	string              	                    
salary              	float               	                    
subordinates        	array<string>       	                    
deductions          	map<string,float>   	                    
address             	struct<street:string,city:string,state:string,zip:int>	                    
country             	string              	                    
state               	string              	                    
	 	 
# Partition Information	 	 
# col_name            	data_type           	comment             
	 	 
country             	string              	                    
state               	string              	                    
	 	 
Detailed Partition Information	Partition(values:[US, CA], dbName:testdb, tableName:staged_employees, createTime:1507896378, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:name, type:string, comment:null), FieldSchema(name:salary, type:float, comment:null), FieldSchema(name:subordinates, type:array<string>, comment:null), FieldSchema(name:deductions, type:map<string,float>, comment:null), FieldSchema(name:address, type:struct<street:string,city:string,state:string,zip:int>, comment:null), FieldSchema(name:country, type:string, comment:null), FieldSchema(name:state, type:string, comment:null)], location:viewfs://hadoop-meituan-test/user/hive/warehouse/testdb.db/staged_employees/country=US/state=CA, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{colelction.delim=|, mapkey.delim==, serialization.format=,, line.delim=	 
, field.delim=,}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:{numFiles=1, transient_lastDdlTime=1507896631, COLUMN_STATS_ACCURATE=true, totalSize=427, numRows=0, rawDataSize=0})		 
OK
OK
